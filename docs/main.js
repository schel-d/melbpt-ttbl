!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.css=void 0,exports.css={text:"hsla(220deg, 100%, 4%, 0.8)",paper10:"hsl(220deg, 30%, 93.5%)",accent:"#00a5ca",hoverHighlight:"hsla(220deg, 100%, 18%, 0.1)"}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorDraw=exports.COL_SIZE=exports.ROW_SIZE=void 0;const css_1=require("./css");exports.ROW_SIZE=20,exports.COL_SIZE=48;exports.editorDraw=function(t){const s=t.html.canvas,r=t.html.context,i=t.content,l=i.length,n=null!=(o=null==(e=i[0])?void 0:e.length)?o:0;if(i.some(t=>t.length!==n))throw"Grid is jagged (some columns have more rows than others)";var e=function(t){return(window.devicePixelRatio||1)/(t.backingStorePixelRatio||1)}(r),x=function(t,e,o){var s=t.html.editor.getBoundingClientRect(),r=t.html.stops.getBoundingClientRect().width,i=t.html.services.getBoundingClientRect().height,r=s.width-r,s=s.height-i,i=t.html.editor.scrollLeft,t=t.html.editor.scrollTop,t=Math.max(0,Math.floor(t/exports.ROW_SIZE)),e=Math.min(e,t+Math.ceil(s/exports.ROW_SIZE)+1),s=e-t,i=Math.max(0,Math.floor(i/exports.COL_SIZE)),o=Math.min(o,i+Math.ceil(r/exports.COL_SIZE)+1);return{x1:i,x2:o,y1:t,y2:e,width:o-i,height:s}}(t,n,l);t.html.grid.style.width=exports.COL_SIZE*l+"px",t.html.grid.style.height=exports.ROW_SIZE*n+"px",s.width=exports.COL_SIZE*x.width*e,s.height=exports.ROW_SIZE*x.height*e,s.style.width=exports.COL_SIZE*x.width+"px",s.style.height=exports.ROW_SIZE*x.height+"px",s.style.left=exports.COL_SIZE*x.x1+"px",s.style.top=exports.ROW_SIZE*x.y1+"px",r.clearRect(0,0,s.width,s.height),r.translate(-x.x1*exports.COL_SIZE*e,-x.y1*exports.ROW_SIZE*e),r.scale(e,e),r.fillStyle=css_1.css.paper10;for(let t=x.y1;t<x.y2;t++)t%2==0&&r.fillRect(x.x1*exports.COL_SIZE,t*exports.ROW_SIZE,x.width*exports.COL_SIZE,exports.ROW_SIZE);r.font="0.7rem 'Roboto Mono', monospace",r.fillStyle=css_1.css.text;for(let t=x.x1;t<x.x2;t++)for(let e=x.y1;e<x.y2;e++){const o=i[t][e];r.fillText(o,t*exports.COL_SIZE+7,e*exports.ROW_SIZE+14)}r.fillStyle=css_1.css.hoverHighlight;var o=t.events.mouseOver,p=(null!=o&&r.fillRect(o.x*exports.COL_SIZE,o.y*exports.ROW_SIZE,exports.COL_SIZE,exports.ROW_SIZE),r.lineWidth=Math.round(1.5*e)/e,r.strokeStyle=css_1.css.accent,t.events.selected);if(null!=p){const t=Math.min(p.startX,p.endX),e=Math.max(p.startX,p.endX)-t+1,o=Math.min(p.startY,p.endY),s=Math.max(p.startY,p.endY)-o+1;r.strokeRect(t*exports.COL_SIZE,o*exports.ROW_SIZE,e*exports.COL_SIZE,s*exports.ROW_SIZE)}}},{"./css":1}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorInit=void 0;const editor_draw_1=require("./editor-draw");function editorScrollEvent(e,t){var n=e=window.event||e,n=Math.max(-1,Math.min(1,n.wheelDelta||-n.detail));t.html.editor.scrollLeft-=64*n,e.preventDefault()}function canvasMouseMoveEvent(e,t){t.events.mouseOver=relativeCoords(e,t),t.events.dragging&&(1!=e.buttons?t.events.dragging=!1:(t.events.selected.endX=t.events.mouseOver.x,t.events.selected.endY=t.events.mouseOver.y)),t.draw()}function relativeCoords(e,t){var t=t.html.grid.getBoundingClientRect(),o=e.clientX-t.left,e=e.clientY-t.top;return{x:Math.floor(o/editor_draw_1.COL_SIZE),y:Math.floor(e/editor_draw_1.ROW_SIZE)}}exports.editorInit=function(e){e.draw(),e.html.canvas.addEventListener("mousedown",t=>{t=relativeCoords(t,e);e.events.selected={startX:t.x,startY:t.y,endX:t.x,endY:t.y},e.events.dragging=!0,e.draw()}),e.html.canvas.addEventListener("mouseup",t=>{t=relativeCoords(t,e);e.events.selected.endX=t.x,e.events.selected.endY=t.y,e.events.dragging=!1,e.draw()}),e.html.canvas.addEventListener("mousemove",t=>canvasMouseMoveEvent(t,e)),e.html.canvas.addEventListener("mouseenter",t=>canvasMouseMoveEvent(t,e)),e.html.canvas.addEventListener("mouseleave",()=>{e.events.mouseOver=null,e.draw()}),e.html.editor.addEventListener("scroll",()=>{e.events.mouseOver=null,e.draw()}),e.html.editor.addEventListener("mousewheel",t=>editorScrollEvent(t,e),!1),e.html.editor.addEventListener("DOMMouseScroll",t=>editorScrollEvent(t,e),!1),document.addEventListener("paste",e=>{var t=e.clipboardData.getData("text");console.log(t),e.preventDefault()})}},{"./editor-draw":2}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Editor=void 0;const editor_draw_1=require("./editor-draw"),editor_init_1=require("./editor-init");exports.Editor=class{constructor(t,e,i,n,o){const r=document.getElementById(t),d=document.getElementById(e),s=document.getElementById(i),c=s.getContext("2d"),u=document.getElementById(n),l=document.getElementById(o);this.html={editor:r,grid:d,canvas:s,context:c,stops:u,services:l},this._content=[],this.events={mouseOver:null,selected:null,dragging:!1}}windowResized(){this.events.mouseOver=null,this.draw()}init(){(0,editor_init_1.editorInit)(this)}draw(){(0,editor_draw_1.editorDraw)(this)}set content(t){this._content=t,this.draw()}get content(){return this._content}}},{"./editor-draw":2,"./editor-init":3}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const editor_1=require("./editor"),network_1=require("./network"),new_timetable_dialog_1=require("./new-timetable-dialog"),editor=new editor_1.Editor("editor","grid","grid-canvas","stops","services"),network=(editor.init(),window.addEventListener("resize",()=>editor.windowResized()),new network_1.Network);network.load().then(()=>{editor.content=[],document.querySelector("#status-loading").classList.add("gone"),document.querySelector("#status").classList.remove("gone"),document.querySelector("#status-ready").classList.remove("gone"),document.querySelector("#new-timetable-button").disabled=!1,document.querySelector("#import-button").disabled=!1}),(0,new_timetable_dialog_1.setup)(),document.querySelector("#new-timetable-button").addEventListener("click",()=>{alert("Coming soon!")}),document.querySelector("#import-button").addEventListener("click",()=>{alert("Coming soon!")})},{"./editor":4,"./network":6,"./new-timetable-dialog":7}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Network=void 0;exports.Network=class{constructor(t="api.trainarrives.in"){this.domain=t,this.json=null}async load(){const t=await fetch(`https://${this.domain}/network/v1`);if(200!=t.status)throw new Error(`"${this.domain}" did not respond.`);this.json=await t.json()}get lines(){if(null==this.json)throw new Error("Network not loaded.");return this.json.lines}}},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.show=exports.setup=void 0;const dialogID="#new-timetable-dialog";exports.setup=function(){document.querySelector("#new-timetable-dialog-cancel").addEventListener("click",()=>{document.querySelector(dialogID).close()}),document.querySelector("#new-timetable-dialog-submit").addEventListener("click",()=>{document.querySelector(dialogID).close()})},exports.show=function(e){const t=[...e.lines].sort((e,t)=>e.name.localeCompare(t.name)),o=document.querySelector(dialogID),l=document.querySelector("#new-timetable-dialog-lines");for(;l.lastChild;)l.removeChild(l.lastChild);t.map(e=>{e=new Option(e.name,e.id.toString());l.appendChild(e)}),o.showModal()}},{}]},{},[5]);
